import React, { useState } from 'react';
import './Experience.css';

const Experience = () => {
  const [showModal, setShowModal] = useState(false);
  const [activeJob, setActiveJob] = useState(null);

  const experiences = [
    {
      id: 1,
      company: 'ООО "Авроид"',
      position: 'Инженер по тестированию ПО',
      location: 'Москва',
      period: '12.03.2024 — настоящее время',
      category: 'Информационные технологии, системная интеграция, интернет',
      responsibilities: [
        'Взаимодействие и консультации по техническим вопросам с отделами поддержки и разработки',
        'Поддержка и консультация важных клиентов компании и решение нетривиальных проблем',
        'Разработка и интеграция Telegram-решений для автоматизации рабочих процессов',
        'Проведение тестирования API с использованием Postman и разработка документации для API',
        'Создание и поддержка коллекции автотестов в Postman',
        'Автоматизация тестирования на уровне API с использованием Python и библиотеки requests',
        'Развертывание тестовых сред с использованием Docker и Aurora SDK',
        'Проведение технических собеседований'
      ]
    },
    {
      id: 2,
      company: 'ООО "Новые Облачные Технологии" ("МойОфис")',
      position: 'Инженер по тестированию ПО',
      location: 'Москва',
      period: '10.01.2023 — 11.03.2024',
      category: 'Информационные технологии, системная интеграция, интернет',
      responsibilities: [
        'Системная интеграция, автоматизация технологических и бизнес-процессов предприятия, ИТ-консалтинг',
        'Стал самым молодым сотрудником компании',
        'Проведение всех видов тестирования и работа на самых разных платформах (web, mac, win, iOS, Android, Linux, Aurora)',
        'Участие в разработке тестовой документации (тест-кейсы, чек-листы, отчеты о дефектах)',
        'Создание и поддержка автоматизированных тестов для web-приложений с использованием Python и Selenium WebDriver',
        'Проведение тестирования API с использованием Postman и разработка документации для API',
        'Создание документации для тестирования безопасности и проведение тестирования на уровне API',
        'Развертывание тестовых сред с использованием Docker и Kubernetes'
      ]
    },
    {
      id: 3,
      company: 'ООО "Новые Облачные Технологии" ("МойОфис")',
      position: 'Стажер',
      location: 'Москва',
      period: '1.08.2022 — 1.09.2023',
      responsibilities: [
        'Освоение методологий тестирования и лучших практик обеспечения качества ПО',
        'Участие в тестировании производительности офисных приложений',
        'Получил лучший результат на тестовом задании среди всех кандидатов'
      ]
    }
  ];

  // Данные о проектах для каждого места работы
  const jobProjects = {
    '1': [
      {
        title: 'Проведение всех этапов и видов тестирования',
        description: `<strong>Контекст:</strong> Необходимость обеспечения высокого качества продуктов компании на всех этапах разработки.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Разработал комплексную стратегию тестирования, охватывающую все ключевые компоненты</li>
          <li>Внедрил систему метрик для оценки покрытия тестами и качества продукта</li>
          <li>Создал библиотеку многоразовых тестовых сценариев для ускорения процесса тестирования</li>
        </ul>
        <strong>Результат:</strong> Сокращение времени тестирования на 30% при повышении качества продукта и снижении количества критических дефектов в релизах на 40%.`,
        technologies: ['Postman', 'Python', 'Docker', 'Aurora OS', 'Selenium', 'TestRail']
      },
      {
        title: 'Создание процессов для отдела выходного тестирования',
        description: `<strong>Контекст:</strong> Отсутствие стандартизированного подхода к выходному тестированию приводило к пропуску критических дефектов.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Спроектировал и внедрил новый процесс проверки качества перед выпуском продукта</li>
          <li>Разработал набор автоматизированных проверок для выявления потенциальных проблем</li>
          <li>Создал инструментарий для анализа и визуализации результатов тестирования</li>
        </ul>
        <strong>Результат:</strong> Улучшение качества выпускаемых продуктов, сокращение числа отзывов релизов с 12% до 3% в течение 6 месяцев после внедрения.`,
        technologies: ['Eva', 'Python', 'CI/CD', 'Bash-скрипты']
      },
      {
        title: 'Поднятие "хоумолаб" сервера для отдела',
        description: `<strong>Контекст:</strong> Недостаток тестовых сред для проведения полноценного тестирования приводил к задержкам в разработке.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Спроектировал и развернул внутренний сервер для тестирования с использованием технологий виртуализации</li>
          <li>Настроил автоматическое создание и восстановление тестовых окружений</li>
          <li>Разработал документацию и обучил команду работе с сервером</li>
        </ul>
        <strong>Результат:</strong> Ускорение процесса тестирования на 40%, возможность параллельного тестирования нескольких версий продукта и экономия на облачной инфраструктуре.`,
        technologies: ['Proxmox', 'Docker', 'Linux', 'Ansible', 'Bash', 'VMware ESXi']
      },
      {
        title: 'Оптимизация процессов для отдела поддержки',
        description: `<strong>Контекст:</strong> Высокая нагрузка на отдел поддержки и длительное время обработки запросов клиентов.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Провел анализ существующих процессов и выявил узкие места</li>
          <li>Разработал систему автоматической категоризации запросов</li>
          <li>Создал базу знаний и набор готовых решений для типовых проблем</li>
        </ul>
        <strong>Результат:</strong> Сокращение среднего времени реакции на запросы на 60%, повышение удовлетворенности клиентов и уменьшение нагрузки на сотрудников поддержки.`,
        technologies: ['ServiceDesk', 'Telegram API', 'Python', 'SQL', 'Аналитика данных']
      },
      {
        title: 'Создание внутренней документации по Авроре и Телеграму',
        description: `<strong>Контекст:</strong> Недостаток структурированной технической документации затруднял обучение новых сотрудников и работу над проектами.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Разработал подробную документацию по работе с ОС Аврора и Telegram API</li>
          <li>Создал пошаговые руководства по настройке и отладке приложений</li>
          <li>Подготовил учебные материалы и провел обучающие семинары</li>
        </ul>
        <strong>Результат:</strong> Сокращение времени на обучение новых сотрудников на 50%, улучшение качества кода и ускорение процесса разработки благодаря единым стандартам.`,
        technologies: ['Confluence', 'Markdown', 'Git', 'Aurora SDK', 'Telegram API']
      },
      {
        title: 'Создание фермы аккаунтов (ботов) для телеграма',
        description: `<strong>Контекст:</strong> Необходимость масштабного тестирования интеграций с Telegram и симуляции нагрузки от множества пользователей.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Разработал автоматизированную систему создания и управления множеством Telegram-аккаунтов</li>
          <li>Реализовал механизмы обхода ограничений и защиты от блокировок</li>
          <li>Создал API для управления аккаунтами из тестовых сценариев</li>
        </ul>
        <strong>Результат:</strong> Создание стабильной тестовой инфраструктуры с более чем 1000 активных ботов, возможность реалистичного тестирования нагрузки и пользовательских сценариев.`,
        technologies: ['Python', 'Telethon', 'Requests', 'SQLite', 'Docker', 'Proxy-серверы']
      },
      {
        title: 'Написание с нуля софта для нагрузочного тестирования Облака компании',
        description: `<strong>Контекст:</strong> Отсутствие специализированных инструментов для тестирования уникальной облачной инфраструктуры компании.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Спроектировал и разработал инструмент для нагрузочного тестирования с учетом специфики облака</li>
          <li>Реализовал различные сценарии нагрузки, имитирующие реальные пользовательские паттерны</li>
          <li>Создал систему мониторинга и анализа результатов с автоматическими отчетами</li>
        </ul>
        <strong>Результат:</strong> Выявление и устранение узких мест в инфраструктуре, повышение производительности облака на 35% и способность обрабатывать в 2.5 раза больше одновременных пользователей.`,
        technologies: ['Python', 'Telethon', 'Requests', 'PostgreSQL', 'Prometheus', 'Grafana', 'Многопоточность']
      },
      {
        title: 'Создание телеграм бота для Поддержки',
        description: `<strong>Контекст:</strong> Растущее количество обращений в поддержку требовало автоматизации и улучшения процесса взаимодействия с клиентами.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Разработал многофункционального Telegram-бота для автоматизации работы отдела поддержки</li>
          <li>Интегрировал бота с CRM-системой компании для отслеживания истории обращений</li>
          <li>Внедрил элементы ИИ для классификации запросов и автоматических ответов</li>
        </ul>
        <strong>Результат:</strong> Сокращение времени на обработку стандартных запросов на 70%, возможность работы поддержки 24/7 и повышение удовлетворенности клиентов благодаря быстрым и точным ответам.`,
        technologies: ['Python', 'Telegram Bot API', 'CRM API', 'SQLAlchemy', 'Docker', 'REST API']
      }
    ],
    '2': [
      {
        title: 'Кросс-платформенное тестирование',
        description: `<strong>Контекст:</strong> Необходимость обеспечения стабильной работы продуктов на всех поддерживаемых платформах.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Проводил тестирование на семи различных платформах и операционных системах</li>
          <li>Разработал методологию обнаружения кросс-платформенных несоответствий</li>
          <li>Создал матрицу совместимости для всех компонентов продукта</li>
        </ul>
        <strong>Платформы:</strong>
        <div class="platforms-container">
          <span class="platform-badge"><span class="platform-emoji">🌐</span> Web</span>
          <span class="platform-badge"><span class="platform-emoji">🍎</span> macOS</span>
          <span class="platform-badge"><span class="platform-emoji">🪟</span> Windows</span>
          <span class="platform-badge"><span class="platform-emoji">📱</span> iOS</span>
          <span class="platform-badge"><span class="platform-emoji">🤖</span> Android</span>
          <span class="platform-badge"><span class="platform-emoji">🐧</span> Linux</span>
          <span class="platform-badge"><span class="platform-emoji">🚀</span> Aurora</span>
        </div>
        <strong>Результат:</strong> Существенное повышение стабильности работы приложений на всех платформах, уменьшение платформо-специфичных ошибок на 65%.`,
        technologies: ['Cross-Platform Testing', 'BrowserStack', 'TestRail', 'Device Testing']
      },
      {
        title: 'DevOps поддержка отдела тестирования',
        description: `<strong>Контекст:</strong> Отсутствие специалиста DevOps в команде тестирования создавало задержки в настройке и обслуживании тестовых окружений.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Взял на себя роль DevOps-инженера для отдела тестирования</li>
          <li>Автоматизировал развертывание тестовых стендов с использованием Docker и Kubernetes</li>
          <li>Настроил CI/CD пайплайны для автоматической установки и обновления тестовых продуктов</li>
          <li>Создал скрипты для быстрого восстановления тестовых сред после сбоев</li>
        </ul>
        <strong>Результат:</strong> Сокращение времени на подготовку тестовых окружений с нескольких дней до нескольких часов, повышение стабильности инфраструктуры и эффективности работы команды.`,
        technologies: ['Docker', 'Kubernetes', 'CI/CD', 'Bash/Python скрипты', 'Jenkins', 'Linux']
      },
      {
        title: 'Автоматизация API-тестирования в Postman',
        description: `<strong>Контекст:</strong> Ручное тестирование API занимало значительное время и не обеспечивало достаточной регрессии.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Создал обширную коллекцию автоматизированных тестов для всех API компании</li>
          <li>Разработал фреймворк для параметризованного тестирования и генерации тестовых данных</li>
          <li>Внедрил систему мониторинга работоспособности API в режиме реального времени</li>
          <li>Интегрировал Postman-тесты с CI/CD системой для непрерывного тестирования</li>
        </ul>
        <strong>Результат:</strong> Автоматизация более 90% API-тестов, сокращение времени обнаружения регрессий в API с нескольких дней до нескольких минут, значительное повышение стабильности бэкенда.`,
        technologies: ['Postman', 'Newman', 'JavaScript', 'CI/CD', 'JSON Schema', 'REST API']
      },
      {
        title: 'Управление тестовой документацией',
        description: `<strong>Контекст:</strong> Устаревшая и разрозненная тестовая документация затрудняла эффективное тестирование.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Актуализировал и систематизировал всю тестовую документацию компании</li>
          <li>Разработал новые шаблоны чек-листов и тест-кейсов с улучшенной структурой</li>
          <li>Внедрил систему автоматического обновления документации при изменении функциональности</li>
          <li>Создал базу знаний для команды тестирования с лучшими практиками и решениями распространенных проблем</li>
        </ul>
        <strong>Результат:</strong> Повышение эффективности тестирования на 40%, сокращение времени онбординга новых сотрудников с 3 недель до 1 недели, улучшение качества релизов.`,
        technologies: ['Confluence', 'Jira', 'TestRail', 'Markdown', 'Mind Maps']
      },
      {
        title: 'Сетевое тестирование и анализ трафика',
        description: `<strong>Контекст:</strong> Необходимость отладки сложных сетевых взаимодействий между компонентами приложений.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Использовал сниферы для анализа и отладки сетевого трафика приложений</li>
          <li>Разработал методологию тестирования сетевых аспектов продуктов</li>
          <li>Выявил и помог устранить ряд критических проблем в передаче данных</li>
        </ul>
        <strong>Результат:</strong> Обнаружение и исправление нескольких трудноуловимых ошибок, оптимизация сетевого взаимодействия и повышение безопасности приложений.`,
        technologies: ['Proxyman', 'Wireshark', 'Charles Proxy', 'SSL/TLS', 'REST/WebSocket']
      },
      {
        title: 'Работа с эмуляторами и создание тестовой фермы',
        description: `<strong>Контекст:</strong> Ограниченный доступ к физическим устройствам для тестирования мобильных версий приложений.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Настроил и поддерживал эмуляторы для различных платформ (Android, iOS, Aurora)</li>
          <li>Создал небольшую "ферму" эмуляторов для параллельного тестирования</li>
          <li>Автоматизировал создание и настройку новых эмуляторов с заданными параметрами</li>
          <li>Разработал сценарии для автоматического тестирования на эмуляторах</li>
        </ul>
        <strong>Эмуляторы:</strong>
        <div class="platforms-container">
          <span class="platform-badge highlighted"><span class="platform-emoji">🤖</span> Android Studio</span>
          <span class="platform-badge"><span class="platform-emoji">🍎</span> Xcode iOS</span>
          <span class="platform-badge highlighted"><span class="platform-emoji">🚀</span> Aurora SDK</span>
        </div>
        <strong>Результат:</strong> Экономия на закупке физических устройств, ускорение процесса тестирования на различных версиях ОС и разрешениях экранов, улучшение качества мобильных приложений.`,
        technologies: ['Android Studio', 'Xcode', 'Aurora SDK', 'Emulators', 'ADB', 'Appium']
      },
      {
        title: 'Мобильное тестирование',
        description: `<strong>Контекст:</strong> Значительная часть пользователей компании использует мобильные устройства, что требовало особого внимания к этим платформам.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Посвятил примерно 50% рабочего времени тестированию и улучшению мобильных приложений</li>
          <li>Перешел от специализации на Android к всестороннему тестированию iOS</li>
          <li>Разработал методологию для выявления платформо-специфичных проблем</li>
          <li>Создал руководство по тестированию мобильных приложений для компании</li>
        </ul>
        <strong>Платформы:</strong>
        <div class="mobile-progression">
          <div class="platform-progress">
            <span class="platform-emoji-large">🤖</span>
            <div class="arrow">→</div>
            <span class="platform-emoji-large">📱</span>
          </div>
          <div class="platform-caption">Переход от Android к iOS</div>
        </div>
        <strong>Результат:</strong> Существенное улучшение качества и стабильности мобильных приложений, рост рейтинга в магазинах приложений с 3.6 до 4.5 звезд, сокращение количества пользовательских жалоб на 75%.`,
        technologies: ['iOS', 'Android', 'Mobile Testing', 'TestFlight', 'Play Console']
      },
      {
        title: 'Разработка тестовой документации',
        description: `<strong>Контекст:</strong> Отсутствие стандартизированной документации для тестирования на разных платформах.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Разработал комплексную тестовую документацию для web, desktop и мобильных версий продукта</li>
          <li>Создал систему шаблонов для ускорения создания новых тест-кейсов</li>
          <li>Внедрил методологию для поддержания документации в актуальном состоянии</li>
        </ul>
        <strong>Результат:</strong> Структурированный подход к тестированию, сокращение времени на онбординг новых тестировщиков и повышение качества продукта.`,
        technologies: ['TestRail', 'Confluence', 'Jira']
      },
      {
        title: 'Автоматизация web-тестирования на Python',
        description: `<strong>Контекст:</strong> Необходимость автоматизации регрессионного тестирования web-приложений для ускорения релизов.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Разработал фреймворк для автоматизации тестирования с использованием Python и Selenium</li>
          <li>Внедрил паттерн Page Object для улучшения поддерживаемости тестов</li>
          <li>Интегрировал автотесты в CI/CD пайплайн для непрерывного тестирования</li>
          <li>Создал систему генерации подробных отчетов о результатах тестирования</li>
        </ul>
        <strong>Технологический стек:</strong>
        <div class="tech-stack-visual">
          <div class="tech-item">Python</div>
          <div class="tech-item">Selenium</div>
          <div class="tech-item">pytest</div>
          <div class="tech-item">requests</div>
          <div class="tech-item">WebDriver</div>
        </div>
        <strong>Результат:</strong> Автоматизация более 80% регрессионных тестов, сокращение времени тестирования с нескольких дней до нескольких часов, значительное улучшение качества продукта.`,
        technologies: ['Python', 'Selenium', 'pytest', 'requests', 'WebDriver', 'Page Object Pattern', 'Docker']
      }
    ],
    '3': [
      {
        title: 'Тестирование производительности',
        description: `<strong>Контекст:</strong> Необходимость оптимизации производительности офисных приложений на различных платформах.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Участвовал в разработке методологии тестирования производительности</li>
          <li>Проводил тесты и анализировал результаты для выявления узких мест</li>
          <li>Предлагал рекомендации по оптимизации</li>
        </ul>
        <strong>Результат:</strong> Улучшение отзывчивости приложений, оптимизация использования ресурсов и улучшение пользовательского опыта.`,
        technologies: ['JMeter', 'Анализ логов', 'Оптимизация производительности']
      },
      {
        title: 'Освоение QA методологий',
        description: `<strong>Контекст:</strong> Начало карьеры в QA и необходимость быстрого освоения методологий тестирования.<br/><br/>
        <strong>Мой вклад:</strong>
        <ul>
          <li>Изучил и применил на практике различные техники тестирования</li>
          <li>Активно участвовал в командных обсуждениях и ретроспективах</li>
          <li>Предлагал улучшения в процессы тестирования</li>
        </ul>
        <strong>Результат:</strong> Получение солидной теоретической базы и практического опыта, быстрая адаптация к рабочим процессам компании.`,
        technologies: ['Функциональное тестирование', 'Регрессионное тестирование', 'Тестовая документация']
      }
    ]
  };

  const openModal = (jobId) => {
    setActiveJob(jobId);
    setShowModal(true);
    // Блокируем прокрутку страницы при открытом модальном окне
    document.body.style.overflow = 'hidden';
  };

  const closeModal = () => {
    setShowModal(false);
    setActiveJob(null);
    // Восстанавливаем прокрутку страницы
    document.body.style.overflow = 'auto';
  };

  // При клике на фон модального окна (но не на его содержимое) - закрываем окно
  const handleModalBackdropClick = (e) => {
    if (e.target === e.currentTarget) {
      closeModal();
    }
  };

  return (
    <div className="experience-container">
      <h1 className="section-title">Опыт работы</h1>
      <p className="section-subtitle">Более 3 лет в IT-индустрии</p>

      <div className="timeline">
        {experiences.map((exp) => (
          <div key={exp.id} className="timeline-item">
            <div className="timeline-marker"></div>
            <div className="timeline-content">
              <div className="timeline-header">
                <h3 className="job-title">{exp.position}</h3>
                <span className="job-company">{exp.company}</span>
                <span className="job-period">{exp.period}</span>
              </div>
              <div className="job-location">
                <i className="fas fa-map-marker-alt"></i> {exp.location}
              </div>
              {exp.category && (
                <div className="job-category">
                  <i className="fas fa-tag"></i> {exp.category}
                </div>
              )}
              <ul className="job-responsibilities">
                {exp.responsibilities.map((resp, index) => (
                  <li key={index}>{resp}</li>
                ))}
              </ul>
              <button
                className="projects-btn"
                onClick={() => openModal(exp.id.toString())}
              >
                Задачи и проекты
              </button>
            </div>
          </div>
        ))}
      </div>

      {/* Модальное окно с проектами */}
      {showModal && activeJob && jobProjects[activeJob] && (
        <div className="modal-backdrop" onClick={handleModalBackdropClick}>
          <div className="modal-content">
            <button className="modal-close" onClick={closeModal}>×</button>
            <h2>Задачи и проекты</h2>

            <div className="projects-list">
              {jobProjects[activeJob].map((project, index) => (
                <div className="project-item" key={index}>
                  <h3>{project.title}</h3>
                  <div
                    className="project-description"
                    dangerouslySetInnerHTML={{ __html: project.description }}
                  ></div>
                  <div className="project-technologies">
                    {project.technologies.map((tech, techIndex) => (
                      <span className="tech-badge" key={techIndex}>{tech}</span>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default Experience;